
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>dynamite_sdk.objects.events &#8212; dynamite_sdk 11/15/2019 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for dynamite_sdk.objects.events</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">ipaddress</span> <span class="k">import</span> <span class="n">ip_address</span>
<span class="kn">from</span> <span class="nn">dateutil.parser</span> <span class="k">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">date_parse</span>


<div class="viewcode-block" id="InvalidEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing an event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidConnectionEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidConnectionEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidConnectionEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw conn event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a conn event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidConnectionEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidDhcpEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidDhcpEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidDhcpEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw dhcp event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a dhcp event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidDhcpEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidDnsEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidDnsEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidDnsEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw dns event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a dns event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidDnsEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidHttpEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidHttpEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidHttpEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw http event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a http event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidHttpEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidSipEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidSipEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidSipEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw sip event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a sip event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidSipEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidSnmpEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidSnmpEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidSnmpEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw snmp event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a snmp event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidSnmpEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="InvalidSshEventError"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.InvalidSshEventError">[docs]</a><span class="k">class</span> <span class="nc">InvalidSshEventError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Thrown when an unexpected raw ssh event format is encountered</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :param message: A more specific error message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;An error occurred while parsing a ssh event: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">InvalidSshEventError</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Event"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.Event">[docs]</a><span class="k">class</span> <span class="nc">Event</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Super generic Event; any Zeek/Flow event can be normalized into this object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span> <span class="o">=</span> <span class="n">raw_event_document</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: The type of event (Either &quot;flow&quot; or a Zeek log prefix)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_time</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: The UTC-0 time at which the event occurred</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: The sender IP in the event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: The recipient IP in the event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_port</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1">#: The sender port in the event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_port</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1">#: The recipient port in the event</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elasticsearch_index</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The ElasticSearch index where the event was found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originating_agent_tag</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The friendly name of the agent (Zeek events only)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forwarder_type</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: Either &quot;zeek&quot; or &quot;netflow&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_ip_address</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: The ip_address of the originating host (collector/agent IP)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_hostname</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: The hostname of the originating host (collector/agent hostname)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="kc">None</span>                       <span class="c1">#: The unique id for the Zeek connection</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_event</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_parse_raw_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse common zeek/flow fields</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elasticsearch_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_index&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing index field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing _source section&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="n">_source</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">][</span><span class="s1">&#39;ipaddr&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing node_ip_address field&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Invalid node_ip_address field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_source</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">][</span><span class="s1">&#39;ipaddr&#39;</span><span class="p">]))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originating_agent_tag</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">][</span><span class="s1">&#39;originating_agent_tag&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forwarder_type</span> <span class="o">=</span> <span class="s1">&#39;zeek&#39;</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forwarder_type</span> <span class="o">=</span> <span class="s1">&#39;netflow&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_hostname</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;node&#39;</span><span class="p">][</span><span class="s1">&#39;hostname&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing node_hostname field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;event_type&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing event_type field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">event_time</span> <span class="o">=</span> <span class="n">date_parse</span><span class="p">(</span><span class="n">_source</span><span class="p">[</span><span class="s1">&#39;@timestamp&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing event_time field&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Invalid event_time field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_source</span><span class="p">[</span><span class="s1">&#39;@timestamp&#39;</span><span class="p">]))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">][</span><span class="s1">&#39;src_addr&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;id.orig_h&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;client_addr&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing source_ip_addressess field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Invalid source_ip_address field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">][</span><span class="s1">&#39;dst_addr&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;id.resp_h&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;server_addr&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">InvalidEventError</span><span class="p">(</span><span class="s1">&#39;Missing destination_ip_address field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="s1">&#39;Invalid destination_ip_addr field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">][</span><span class="s1">&#39;src_port&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">source_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;id.orig_p&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">source_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;client_port&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destination_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">][</span><span class="s1">&#39;dst_port&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">destination_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;id.resp_p&#39;</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">destination_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;server_port&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;uid&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">][</span><span class="s1">&#39;uids&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: High-level representation of the connection</span>

<span class="sd">        [ssl][2017-10-09 15:52:34+00:00]192.168.1.201:39334 -&gt; 192.168.1.250:443</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">{}</span><span class="s1">][</span><span class="si">{}</span><span class="s1">][</span><span class="si">{}</span><span class="s1">]</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1"> -&gt; </span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forwarder_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_time</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">source_ip_address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_port</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">destination_ip_address</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">destination_port</span><span class="p">)</span>

<div class="viewcode-block" id="Event.to_dataframe"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.Event.to_dataframe">[docs]</a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: DataFrame containng the field headings and single of of values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ignore_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;raw_event_document&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">]</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_vars</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span> <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ConnectionEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.ConnectionEvent">[docs]</a><span class="k">class</span> <span class="nc">ConnectionEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a log generated either by a NetFlow forwarder OR Zeek conn.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/conn/main.zeek.html#type-Conn::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip_protocol</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: Layer3 transport protocol TCP/UDP/ICMP</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_bytes</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: Total bytes both sent and received</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_packets</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: Total packets sent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_port</span> <span class="o">=</span> <span class="kc">None</span>                   <span class="c1">#: A recognized service port (non-ephemeral)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: The IP address of the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: The IP address of the server in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_hostname</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: The hostname of the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_hostname</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: The hostname of the server in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_mac_address</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: The Layer2 MAC address of the source device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_mac_address</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1">#: The Layer2 MAC address of the destination device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_autonomous_system</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The name corresponding to an ASN for the source system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_autonomous_system</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: The name corresponding to an ASN for the destination system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_autonomous_system</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The name corresponding to an ASN for the client system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_autonomous_system</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The name corresponding to an ASN for the server system</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_city</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: The city for the source in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_country</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: The country for the source in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_country_code</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The country code for the source in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_geo_location</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The geographical coordinates for the source in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_city</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1">#: The city for the destination in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_country</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The country for the destination in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_country_code</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The country code for the destination in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_geo_location</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The geographical coordinates for the dst in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_city</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: The city for the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_country</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: The country for the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_country_code</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The country code for the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_geo_location</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The geographical coordinates for the client in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_city</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: The city for the server in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_country</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: The country for the server in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_country_code</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The country code for the server in the conversation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_geo_location</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The geographical coordinates for the server in the conversation</span>

        <span class="c1"># Zeek Only</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="kc">None</span>                        <span class="c1">#: An identification of an application protocol being sent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connection_state</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1">#: The state of the connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>                       <span class="c1">#: The number of seconds for a given connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originated_locally</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: True, if the connection originated from inside the network</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_bytes</span> <span class="o">=</span> <span class="kc">None</span>                   <span class="c1">#: The number of bytes sent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_bytes</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: The number of bytes received</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_packets</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: The number of packets sent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_packets</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The number of packets received</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="kc">None</span>                        <span class="c1">#: The state history of connections as a string of letters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="kc">None</span>                            <span class="c1">#: A unique identifier for the connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_conn_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_conn_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;conn&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidConnectionEventError</span><span class="p">(</span><span class="s1">&#39;Invalid conn record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip_protocol</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ip_protocol&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_bytes</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bytes&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_packets</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;packets&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;service_port&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_addr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_addr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_hostname</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_hostname&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_hostname</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_hostname&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_mac_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;source_mac_address&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_mac_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;destination_mac_address&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_autonomous_system</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;src_autonomous_system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_autonomous_system</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dst_autonomous_system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_autonomous_system</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_autonomous_system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_autonomous_system</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_autonomous_system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_city</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;src_city&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_country</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;src_country&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_country_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;src_country_code&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_city</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dst_city&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_country</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dst_country&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination_country_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dst_country_code&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_city</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_city&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_country</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_country&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_country_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_country_code&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_city</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_city&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_country</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_country&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_country_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_country_code&#39;</span><span class="p">)</span>

        <span class="n">source_geo_location</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;src_geo_location&#39;</span><span class="p">)</span>
        <span class="n">destination_geo_location</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dst_geo_location&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_geo_location</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_geo_location</span> <span class="o">=</span> <span class="n">source_geo_location</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">source_geo_location</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">destination_geo_location</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destination_geo_location</span> <span class="o">=</span> <span class="n">destination_geo_location</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">destination_geo_location</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_geo_location</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_geo_location&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_geo_location</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_geo_location&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">InvalidConnectionEventError</span><span class="p">(</span><span class="s1">&#39;Invalid client_ip_address field&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">InvalidConnectionEventError</span><span class="p">(</span><span class="s1">&#39;Invalid server_ip_address field&#39;</span><span class="p">)</span>

        <span class="c1"># Get Zeek specific conn.log fields</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;service&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connection_state</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;conn_state&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duration&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originated_locally</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;local_orig&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;history&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="p">)</span>
            <span class="n">orig_ip_bytes</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_ip_bytes&#39;</span><span class="p">)</span>
            <span class="n">orig_bytes</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_ip_bytes&#39;</span><span class="p">)</span>
            <span class="n">resp_ip_bytes</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_ip_bytes&#39;</span><span class="p">)</span>
            <span class="n">resp_bytes</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_bytes&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">orig_bytes</span> <span class="ow">and</span> <span class="n">orig_ip_bytes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">source_bytes</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">orig_ip_bytes</span><span class="p">,</span> <span class="n">orig_bytes</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">resp_bytes</span> <span class="ow">and</span> <span class="n">resp_ip_bytes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">destination_bytes</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">resp_ip_bytes</span><span class="p">,</span> <span class="n">resp_bytes</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">source_packets</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_pkts&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">destination_packets</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_pkts&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the ConnectionEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="DhcpEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.DhcpEvent">[docs]</a><span class="k">class</span> <span class="nc">DhcpEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek dhcp.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/dhcp/main.zeek.html#type-DHCP::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The IP address of the client requesting the DHCP lease</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The IP address of the server involved in actually handing out the lease</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_port</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: Client port # seen at time of server handing out IP (expected as 68/udp)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: Server port # seen at time of server handing out IP (expected as 67/udp).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mac_address</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: Client’s hardware address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: Name given by client in Hostname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_fqdn</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: FQDN given by client in Client FQDN</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Domain given by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">requested_ip_address</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: IP address requested by the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assigned_ip_address</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1">#: IP address assigned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lease_time</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: IP address lease interval (seconds)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_message</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1">#: Message typically accompanied with a DHCP_DECLINE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_message</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1">#: Message typically accompanied with a DHCP_NAK</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_types</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: The DHCP message types seen by this DHCP transaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: The time from the first message to the last</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uids</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: Series of unique ids of the connections over which DHCP is occurring.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_dhcp_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_dhcp_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;dhcp&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidDhcpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid dhcp record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_port&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_port&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mac_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mac&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hostname</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host_name&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_fqdn</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_fqdn&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;domain&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">requested_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;requested_addr&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assigned_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;assigned_addr&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lease_time</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;lease_time&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_message</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_message&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_message</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_message&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_types</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;msg_types&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duration&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uids</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uids&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span> <span class="o">=</span> <span class="n">ip_address</span><span class="p">(</span><span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_addr&#39;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidDhcpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid client_ip_address field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_ip_address</span><span class="p">))</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_addr&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">InvalidDhcpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid server_ip_address field [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">server_ip_address</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidDhcpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid dhcp record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the DhcpEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="DnsEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.DnsEvent">[docs]</a><span class="k">class</span> <span class="nc">DnsEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek dns.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/dns/main.zeek.html#type-DNS::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">authoritative_answer</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: True if the responding server is an authority for the domain name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursion_available</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: True if server supports recursive queries</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recursion_desired</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: True if the client wants recursive service for this query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">message_truncated</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: True if the message was truncated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rejected</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: True if the DNS query was rejected by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">answers</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: A set of resource descriptions in the query answer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_type</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: A QTYPE value specifying the type of the query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_type_name</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: A descriptive name for the type of the query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_class</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: The QCLASS value specifying the class of the query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query_class_name</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1">#: A descriptive name for the class of the query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="kc">None</span>                   <span class="c1">#: The domain name that is the subject of the DNS query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_code</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: The response code value in DNS response messages</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_code_name</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: A descriptive name for the response code value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_id</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1">#: A 16-bit identifier assigned by the program that generated the DNS query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">round_trip_time</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: The delay between when the request was seen until the answer started</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_dns_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_dns_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;dns&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidDnsEventError</span><span class="p">(</span><span class="s1">&#39;Invalid dns record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authoritative_answer</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AA&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recursion_available</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RA&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recursion_desired</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RD&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">message_truncated</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TC&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rejected</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rejected&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">answers</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;answers&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query_type</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qtype&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query_type_name</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qtype_name&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query_class</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qclass&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query_class_name</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;qclass_name&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;query&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rcode&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_code_name</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rcode_name&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transaction_id</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trans_id&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">round_trip_time</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rtt&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidDnsEventError</span><span class="p">(</span><span class="s1">&#39;Invalid dns record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the DnsEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="HttpEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.HttpEvent">[docs]</a><span class="k">class</span> <span class="nc">HttpEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek http.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/http/main.zeek.html#type-HTTP::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_depth</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The depth into the connection of this request/response transaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: Verb used in the HTTP request (GET, POST, HEAD, etc.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1">#: Value of the HOST header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uri</span> <span class="o">=</span> <span class="kc">None</span>                     <span class="c1">#: URI used in the request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">referrer</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Value of the “referer” header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: Value of the version portion of the request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: Value of the User-Agent header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: Value of the Origin header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_body_length</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: Actual uncompressed content size of the data transferred from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_body_length</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: Actual uncompressed content size of the data transferred from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: Status code returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_message</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1">#: Status message returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_code</span> <span class="o">=</span> <span class="kc">None</span>               <span class="c1">#: Last seen 1xx informational reply code returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info_message</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: Last seen 1xx informational reply message returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Username if basic-auth is performed for the request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Password if basic-auth is performed for the request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proxied</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: All of the headers that may indicate if the request was proxied</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originating_fuids</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: An ordered list of file unique IDs from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originating_filenames</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1">#: An ordered list of filenames from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originating_mime_types</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: An ordered list of mime types from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipient_fuids</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: An ordered list of file unique IDs from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipient_filenames</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: An ordered list of filenames from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recipient_mime_types</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: An ordered list of mime types from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_header_names</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The list of HTTP header names sent by the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_header_names</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The list of HTTP header names sent by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cookie_variables</span> <span class="o">=</span> <span class="kc">None</span>        <span class="c1">#: Variable names extracted from all cookies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uri_variables</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: Variable names from the URI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_http_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_http_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;http&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidHttpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid http record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transaction_depth</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trans_depth&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uri</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uri&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">referrer</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;referrer&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_agent&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;origin&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_body_length</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request_body_len&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_body_length</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_body_len&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status_code&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_message</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status_msg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info_code&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info_message</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;info_msg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">proxied</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;proxied&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originating_fuids</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_fuids&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originating_filenames</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_filenames&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">originating_mime_types</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;orig_mime_types&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_fuids</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_fuids&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_filenames</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_filenames&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recipient_mime_types</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;resp_mime_types&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_header_names</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client_header_names&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_header_names</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server_header_names&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cookie_variables</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cookie_variables&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uri_variables</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uri_variables&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidHttpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid http record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the HttpEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="SipEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.SipEvent">[docs]</a><span class="k">class</span> <span class="nc">SipEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek sip.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/sip/main.zeek.html#type-SIP::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">transaction_depth</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The depth into the connection of this request/response transaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: Verb used in the SIP request (INVITE, REGISTER etc)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uri</span> <span class="o">=</span> <span class="kc">None</span>                     <span class="c1">#: URI used in the request</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_from</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: Contents of the request From: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_to</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: Contents of the To: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_from</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: Contents of the response From: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_to</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: Contents of the response To: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reply_to</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Contents of the Reply-To: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: Contents of the Call-ID: header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_sequence</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: Contents of the CSeq: header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: Contents of the Subject: header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_path</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The client message transmission path, as extracted from the headers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_path</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: The server message transmission path, as extracted from the headers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="kc">None</span>              <span class="c1">#: Contents of the User-Agent: header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="kc">None</span>             <span class="c1">#: Status code returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_message</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1">#: Status message returned by the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: Contents of the Warning: header</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">request_body_length</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: Contents of the Content-Length: header from the client</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_body_length</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: Contents of the Content-Length: header from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content_type</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: Contents of the Content-Type: header from the server</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_sip_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_sip_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;sip&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidHttpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid sip record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transaction_depth</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;trans_depth&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uri</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uri&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_from</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request_from&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_to</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request_to&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_from</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_from&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_to</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_to&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reply_to</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reply_to&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">call_id</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;call_id&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c_sequence</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;seq&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subject</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;subject&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_path</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request_path&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_path</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_path&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_agent&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_code</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status_code&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status_message</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status_message&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warning</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;warning&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">request_body_length</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;request_body_len&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">response_body_length</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;response_body_len&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSipEventError</span><span class="p">(</span><span class="s1">&#39;Invalid sip record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the SipEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="SnmpEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.SnmpEvent">[docs]</a><span class="k">class</span> <span class="nc">SnmpEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek snmp.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/snmp/main.zeek.html#type-SNMP::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: The time between first/last packet sent in SNMP session</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The version of SNMP being used</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">community_string</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1">#: The community string of the first SNMP packet associated with the session</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_requests</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The number of variable bindings in GetRequest/GetNextRequest PDUs seen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_bulk_requests</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: The number of variable bindings in GetBulkRequest PDUs seen</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_responses</span> <span class="o">=</span> <span class="kc">None</span>      <span class="c1">#: The number of variable bindings in GetResponse/Response PDUs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_requests</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The number of variable bindings in SetRequest PDUs seen for the session</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_string</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1">#: The system description of the SNMP responder endpoint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up_since</span> <span class="o">=</span> <span class="kc">None</span>           <span class="c1">#: The time at which the SNMP responder endpoint claims it’s been up since</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_snmp_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_snmp_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;snmp&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidHttpEventError</span><span class="p">(</span><span class="s1">&#39;Invalid snmp record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;duration&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">community_string</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;community&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_requests</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;get_requests&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_bulk_requests</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;get_bulk_requests&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_responses</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;get_responses&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_requests</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;set_requests&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">display_string</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;display_string&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">up_since</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;up_since&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSipEventError</span><span class="p">(</span><span class="s1">&#39;Invalid snmp record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the SnmpEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>


<div class="viewcode-block" id="SshEvent"><a class="viewcode-back" href="../../../dynamite_sdk/objects/events.html#dynamite_sdk.objects.events.SshEvent">[docs]</a><span class="k">class</span> <span class="nc">SshEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a Zeek ssh.log</span>

<span class="sd">    https://docs.zeek.org/en/stable/scripts/base/protocols/ssh/main.zeek.html#type-SSH::Info</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_event_document</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">raw_event_document</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="kc">None</span>                  <span class="c1">#: SSH major version (1 or 2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authentication_success</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1">#: True if successfully authenticated</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">authentication_attempts</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: The number of authentication attempts observed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="kc">None</span>                <span class="c1">#: Direction of the connection (Outbound/Inbound)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client_version_string</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: The client&#39;s version string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_version_string</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: The server&#39;s version string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cipher_algorithm</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1">#: The encryption algorithm in use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mac_algorithm</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The signing (MAC) algorithm in use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression_algorithm</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1">#: The compression algorithm in use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1">#: The key exchange algorithm in use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host_key_algorithm</span> <span class="o">=</span> <span class="kc">None</span>       <span class="c1">#: The server host key’s algorithm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host_key</span> <span class="o">=</span> <span class="kc">None</span>                 <span class="c1">#: The server’s key fingerprint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_raw_ssh_event</span><span class="p">()</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;raw_event_document&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_raw_ssh_event</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_type</span> <span class="o">!=</span> <span class="s1">&#39;ssh&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSshEventError</span><span class="p">(</span><span class="s1">&#39;Invalid ssh record, got [</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_type</span><span class="p">))</span>
        <span class="n">_source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_event_document</span><span class="p">[</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authentication_success</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auth_success&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">authentication_attempts</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;auth_attempts&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;direction&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">client_version_string</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_version_string</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;server&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cipher_algorithm</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cipher_alg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mac_algorithm</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mac_alg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compression_algorithm</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;compression_alg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">key_algorithm</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;key_alg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">host_key_algorithm</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host_key_alg&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">host_key</span> <span class="o">=</span> <span class="n">_source</span><span class="p">[</span><span class="s1">&#39;zeek&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;host_key&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidSshEventError</span><span class="p">(</span><span class="s1">&#39;Invalid ssh record, missing &quot;zeek&quot; section&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: A JSON representation of the SshEvent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">dynamite_sdk</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Installation/QuickStart</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Libraries</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../dynamite_sdk/search.html">Search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dynamite_sdk/objects/baselines.html">Intervals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dynamite_sdk/objects/events.html">Events</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Jamin Becker.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>